import{r as d,j as i,b as p,d as f}from"./index-react-BgBOD2EG.js";import{u as m,P as g,T as h,C as x}from"./index-react-three-Bw4d-MPV.js";import{M as c}from"./index-threejs-CnVPMkYW.js";import"./index-DWFQb4A4.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function s(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(o){if(o.ep)return;o.ep=!0;const n=s(o);fetch(o.href,n)}})();const l=()=>!window.invokeNative,y=()=>{},j=(e,t)=>e>0&&e<90?t:e>-180&&e<-90||e>0?-t:t,u=(e,t)=>{const s=d.useRef(y);d.useEffect(()=>{s.current=t},[t]),d.useEffect(()=>{const a=o=>{const{action:n,data:r}=o.data;s.current&&n===e&&s.current(r)};return window.addEventListener("message",a),()=>window.removeEventListener("message",a)},[e])};async function z(e,t,s){if(l())return await new Promise(n=>n);const a={method:"post",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify(t)};return await(await fetch(`https://gs_gizmo/${e}`,a)).json()}const v=()=>{const{camera:e}=m();return u("SetCameraPosition",({position:t,rotation:s})=>{e.position.set(t.x,t.z,-t.y),e.rotation.order="YZX",s&&e.rotation.set(c.degToRad(s.x),c.degToRad(j(s.x,s.z)),c.degToRad(s.y)),e.updateProjectionMatrix()}),i.jsx(g,{position:[0,0,10],makeDefault:!0,onUpdate:t=>t.updateProjectionMatrix()})},E=()=>{const e=d.useRef(null),[t,s]=d.useState(),[a,o]=d.useState("translate"),n=()=>{const r={handle:t,position:{x:e.current.position.x,y:-e.current.position.z,z:e.current.position.y-.5},rotation:{x:c.radToDeg(e.current.rotation.x),y:c.radToDeg(-e.current.rotation.z),z:c.radToDeg(e.current.rotation.y)}};z("UpdateEntity",r)};return u("SetupGizmo",r=>{s(r.handle),r.handle&&(e.current.position.set(r.position.x,r.position.z+.5,-r.position.y),e.current.rotation.order="YZX",e.current.rotation.set(c.degToRad(r.rotation.x),c.degToRad(r.rotation.z),c.degToRad(r.rotation.y)),r.gizmoMode&&o(r.gizmoMode))}),u("SetGizmoMode",r=>{o(r)}),i.jsx(i.Fragment,{children:i.jsxs(d.Suspense,{fallback:i.jsx("p",{children:"Loading..."}),children:[t!=null&&i.jsx(h,{size:.5,object:e,mode:a,onObjectChange:n}),i.jsx("mesh",{ref:e})]})})},R=()=>i.jsxs(x,{style:{zIndex:1},children:[i.jsx(v,{}),i.jsx(E,{})]});function T(){return i.jsx("div",{style:{width:"100vw",height:"100vh"},children:i.jsx(R,{})})}p.createRoot(document.getElementById("root")).render(i.jsx(f.StrictMode,{children:i.jsx(T,{})}));if(l()){const e=document.getElementById("root");e.style.backgroundImage='url("https://i.imgur.com/3pzRj9n.png")',e.style.backgroundSize="cover",e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="center"}
