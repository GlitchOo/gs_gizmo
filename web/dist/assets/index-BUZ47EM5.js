import{r as d,j as i,b as l,d as m}from"./index-react-BgBOD2EG.js";import{u as f,P as g,T as h,C as x}from"./index-react-three-Bw4d-MPV.js";import{M as c}from"./index-threejs-CnVPMkYW.js";import"./index-DWFQb4A4.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function o(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(t){if(t.ep)return;t.ep=!0;const s=o(t);fetch(t.href,s)}})();const p=()=>!window.invokeNative,y=()=>{},u=(e,a)=>{const o=d.useRef(y);d.useEffect(()=>{o.current=a},[a]),d.useEffect(()=>{const n=t=>{const{action:s,data:r}=t.data;o.current&&s===e&&o.current(r)};return window.addEventListener("message",n),()=>window.removeEventListener("message",n)},[e])};async function j(e,a,o){if(p())return await new Promise(s=>s);const n={method:"post",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify(a)};return await(await fetch(`https://gs_gizmo/${e}`,n)).json()}const v=()=>{const{camera:e}=f(),a=(o,n)=>o>0&&o<90?n:o>-180&&o<-90||o>0?-n:n;return u("SetCameraPosition",({position:o,rotation:n})=>{e.position.set(o.x,o.z,-o.y),e.rotation.order="YZX",n&&e.rotation.set(c.degToRad(n.x),c.degToRad(a(n.x,n.z)),c.degToRad(n.y)),e.updateProjectionMatrix()}),i.jsx(g,{position:[0,0,10],makeDefault:!0,onUpdate:o=>o.updateProjectionMatrix()})},z=()=>{const e=d.useRef(null),[a,o]=d.useState(),[n,t]=d.useState("translate"),s=()=>{const r={handle:a,position:{x:e.current.position.x,y:-e.current.position.z,z:e.current.position.y-.5},rotation:{x:c.radToDeg(e.current.rotation.x),y:c.radToDeg(-e.current.rotation.z),z:c.radToDeg(e.current.rotation.y)}};j("UpdateEntity",r)};return u("SetupGizmo",r=>{o(r.handle),r.handle&&(e.current.position.set(r.position.x,r.position.z+.5,-r.position.y),e.current.rotation.order="YZX",e.current.rotation.set(c.degToRad(r.rotation.x),c.degToRad(r.rotation.z),c.degToRad(r.rotation.y)),r.gizmoMode&&t(r.gizmoMode))}),u("SetGizmoMode",r=>{t(r)}),i.jsx(i.Fragment,{children:i.jsxs(d.Suspense,{fallback:i.jsx("p",{children:"Loading..."}),children:[a!=null&&i.jsx(h,{size:.5,object:e,mode:n,onObjectChange:s}),i.jsx("mesh",{ref:e})]})})},T=()=>i.jsxs(x,{style:{zIndex:1},children:[i.jsx(v,{}),i.jsx(z,{})]});function E(){return i.jsx("div",{style:{width:"100vw",height:"100vh"},children:i.jsx(T,{})})}l.createRoot(document.getElementById("root")).render(i.jsx(m.StrictMode,{children:i.jsx(E,{})}));if(p()){const e=document.getElementById("root");e.style.backgroundImage='url("https://i.imgur.com/3pzRj9n.png")',e.style.backgroundSize="cover",e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="center"}
